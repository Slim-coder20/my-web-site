{"version":3,"sources":["../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-dom.ts","turbopack:///[project]/components/BuyButton/BuyButton.module.css [app-ssr] (css module)","../../../../components/BuyButton/BuyButton.tsx","../../../../components/PaymentVerifier/PaymentVerifier.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactDOM\n","__turbopack_context__.v({\n  \"buyButton\": \"BuyButton-module__3jIF6a__buyButton\",\n});\n","/**\n * Composant : BuyButton\n *\n * Ce composant affiche le bouton \"Acheter\" sur chaque carte d'album\n * dans la page discographie.\n *\n * FONCTIONNALITÉ :\n * - Au clic, redirige l'utilisateur vers la page de récapitulatif de commande\n * - La page de checkout gérera ensuite la saisie de l'email et le paiement\n *\n * NOTE : Ce composant est un Client Component (\"use client\") car il utilise\n * le hook useRouter de Next.js pour la navigation.\n */\n\n\"use client\";\n\nimport { useRouter } from \"next/navigation\";\nimport styles from \"./BuyButton.module.css\";\n\ninterface BuyButtonProps {\n  productId: number; // ID de l'album à acheter\n  productTitle: string; // Titre de l'album (non utilisé pour l'instant mais peut servir pour l'accessibilité)\n}\n\nexport default function BuyButton({ productId }: BuyButtonProps) {\n  const router = useRouter();\n\n  /**\n   * Gestion du clic sur le bouton \"Acheter\"\n   *\n   * Redirige vers la page de checkout avec l'ID du produit.\n   * Exemple : /checkout/1 pour l'album avec l'ID 1\n   */\n  const handleClick = () => {\n    router.push(`/checkout/${productId}`);\n  };\n\n  return (\n    <button className={styles.buyButton} onClick={handleClick}>\n      Acheter\n    </button>\n  );\n}\n","/**\n * Composant : PaymentVerifier\n *\n * Ce composant vérifie le statut d'un paiement Stripe après la redirection\n * depuis Stripe Checkout et met à jour la commande si nécessaire.\n *\n * UTILISATION :\n * Ajouté à la page discographie pour vérifier automatiquement le paiement\n * quand success=true est dans l'URL.\n */\n\n\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useSearchParams } from \"next/navigation\";\n\nexport default function PaymentVerifier() {\n  const searchParams = useSearchParams();\n  const [status, setStatus] = useState<\"checking\" | \"success\" | \"error\" | null>(\n    null\n  );\n  const [message, setMessage] = useState<string>(\"\");\n\n  useEffect(() => {\n    const sessionId = searchParams.get(\"session_id\");\n\n    // Si pas de session_id dans l'URL, ne rien faire\n    if (!sessionId) {\n      return;\n    }\n\n    // Vérifier le statut du paiement\n    const verifyPayment = async () => {\n      setStatus(\"checking\");\n      setMessage(\"Vérification du paiement...\");\n\n      try {\n        const response = await fetch(\"/api/stripe/verify-payment\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({ sessionId }),\n        });\n\n        const data = await response.json();\n\n        if (response.ok && data.status === \"paid\") {\n          setStatus(\"success\");\n          setMessage(\"Paiement confirmé ! Vous recevrez un email de confirmation.\");\n        } else {\n          setStatus(\"error\");\n          setMessage(data.message || \"Erreur lors de la vérification du paiement\");\n        }\n      } catch (error) {\n        console.error(\"Erreur lors de la vérification du paiement:\", error);\n        setStatus(\"error\");\n        setMessage(\"Erreur lors de la vérification du paiement\");\n      }\n    };\n\n    verifyPayment();\n  }, [searchParams]);\n\n  if (!status) {\n    return null;\n  }\n\n  return (\n    <div\n      style={{\n        padding: \"1rem\",\n        margin: \"1rem 0\",\n        borderRadius: \"4px\",\n        backgroundColor:\n          status === \"success\"\n            ? \"#d4edda\"\n            : status === \"error\"\n            ? \"#f8d7da\"\n            : \"#d1ecf1\",\n        color:\n          status === \"success\"\n            ? \"#155724\"\n            : status === \"error\"\n            ? \"#721c24\"\n            : \"#0c5460\",\n        border: `1px solid ${\n          status === \"success\"\n            ? \"#c3e6cb\"\n            : status === \"error\"\n            ? \"#f5c6cb\"\n            : \"#bee5eb\"\n        }`,\n      }}\n    >\n      {status === \"checking\" && \"⏳ \"}\n      {status === \"success\" && \"✅ \"}\n      {status === \"error\" && \"❌ \"}\n      {message}\n    </div>\n  );\n}\n\n"],"names":["module","exports","require","vendored","ReactDOM"],"mappings":"6CAAAA,EAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,GACRC,QAAQ,CAAC,YAAY,CAAEC,QAAQ,YCFjC,EAAA,CAAA,CAAA,CACA,UAAA,qCACA,2BCUC,IAAA,EAAA,EAAA,CAAA,CAAA,OAID,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAOe,SAAS,EAAU,WAAE,CAAS,CAAkB,EAC7D,IAAM,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAYxB,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,UAAW,EAAA,OAAM,CAAC,SAAS,CAAE,QALnB,CAK4B,IAJ9C,EAAO,IAAI,CAAC,CAAC,UAAU,EAAE,EAAA,CAAW,CACtC,WAG6D,WAI/D,gDCjCC,IAAA,EAAA,EAAA,CAAA,CAAA,OAID,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEe,SAAS,IACtB,IAAM,EAAe,CAAA,EAAA,EAAA,eAAA,AAAe,IAC9B,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAClC,MAEI,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,UA2C/C,CAzCA,CAAA,EAAA,AAyCI,EAzCJ,SAAA,AAAS,EAAC,KACR,IAAM,EAAY,EAAa,GAAG,CAAC,aAGnC,CAAK,GAAD,AAkCJ,CA7BsB,OALN,GAMd,EAAU,YACV,EAAW,+BAEX,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,6BAA8B,CACzD,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,SAAS,CAAC,CAAE,WAAU,EACnC,GAEM,EAAO,MAAM,EAAS,IAAI,GAE5B,EAAS,EAAE,EAAoB,QAAQ,CAAxB,EAAK,MAAM,EAC5B,EAAU,WACV,EAAW,iEAEX,EAAU,SACV,EAAW,EAAK,OAAO,EAAI,8CAE/B,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,8CAA+C,GAC7D,EAAU,SACV,EAAW,6CACb,EACF,GAGF,EAAG,CAAC,EAAa,EAEZ,GAKH,CAAA,EAAA,EALW,AAKX,IAAA,EAAC,MAAA,CACC,MAAO,CACL,QAAS,OACT,OAAQ,SACR,aAAc,MACd,gBACa,YAAX,EACI,UACW,UAAX,EACA,UACA,UACN,MACa,YAAX,EACI,UACW,UAAX,EACA,UACA,UACN,OAAQ,CAAC,UAAU,EACN,YAAX,EACI,UACW,UAAX,EACA,UACA,UAAA,CACJ,AACJ,YAEY,aAAX,GAAyB,KACd,YAAX,GAAwB,KACb,UAAX,GAAsB,KACtB,KAjCI,IAoCX","ignoreList":[0]}